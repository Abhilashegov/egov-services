---
ReportDefinitions:
- reportName: CashCollection
  summary: Cash Collection Report
  version: 1.0.0
  sourceColumns:
  - name: serialnumber
    label: reports.collection.serialno
    type: number
    source: collection
  - name: CHALLAN_NUMBER
    label: reports.collection.challanno
    type: number
    source: seva
  - name: RECEIPT_NUMBER
    label: reports.collection.receiptno
    type: number
    source: completed
  - name: DEPT_NAME
    label: reports.collection.department
    type: string
    source: collection
  - name: INSTRUMENT_AMOUNT
    label: reports.collection.amount
    type: number
    source: seva
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  - name: collectedby
    label: reports.collection.collectedby
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  query: SELECT row_number() over (order by EGCL_COLLECTIONHEADER.RECEIPTNUMBER) as serialnumber, '' AS CHALLAN_NUMBER, EGCL_COLLECTIONHEADER.RECEIPTNUMBER AS RECEIPT_NUMBER, EG_DEPARTMENT.NAME AS DEPT_NAME, '' AS INSTRUMENT_AMOUNT FROM egcl_receiptheader EGCL_COLLECTIONHEADER INNER JOIN eg_businessdetails EGCL_SERVICEDETAILS ON EGCL_COLLECTIONHEADER.businessdetails = EGCL_SERVICEDETAILS.name INNER JOIN EG_DEPARTMENT EG_DEPARTMENT ON EGCL_COLLECTIONHEADER.DEPARTMENT = EG_DEPARTMENT.code WHERE EGCL_COLLECTIONHEADER.status != $status AND EGCL_COLLECTIONHEADER.RECEIPTDATE >= $fromDate AND EGCL_COLLECTIONHEADER.RECEIPTDATE < $toDate AND EGCL_COLLECTIONHEADER.tenantid=$tenantid ORDER BY RECEIPT_NUMBER
  
  
- reportName: ReceiptRegister
  summary: Receipt Register Report
  version: 1.0.0 
  sourceColumns:
  - name: RECEIPT_DATE
    label: reports.collection.receipt.date
    type: epoch
    source: collection
  - name: RECEIPT_NUMBER
    label: reports.collection.receipt.number
    type: string
    source: collection
  - name: DEPARTMENT_NAME
    label: reports.collection.department.name
    type: string
    source: collection
  - name: SERVICE_NAME
    label: reports.collection.service.name
    type: string
    source: collection
  - name: SOURCE
    label: reports.collection.source
    type: string
    source: collection
  - name: CASH_AMOUNT
    label: reports.collection.cashamount
    type: string
    source: collection
  - name: CHEQUEDD_AMOUNT
    label: reports.collection.chequedd_amount
    type: string
    source: collection
  - name: BANK_AMOUNT
    label: reports.collection.bank.amount
    type: string
    source: collection   
  - name: ONLINE_AMOUNT
    label: reports.collection.online.amount
    type: string
    source: collection   
  - name: CARD_AMOUNT
    label: reports.collection.card.amount
    type: string
    source: collection   
  - name: STATUS_DESCRIPTION
    label: reports.collection.status.description
    type: string
    source: collection  
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    source: collection
  - name: department
    label: reports.collection.department
    type: string
    source: collection 
  - name: paymentmode
    label: reports.collection.paymentmode
    type: string
    source: collection 
  - name: businessservice
    label: reports.collection.businessservice
    type: string
    source: collection  
  query: SELECT RECEIPT_DATE,RECEIPT_NUMBER,DEPARTMENT_NAME,SERVICE_NAME,SOURCE,CASH_AMOUNT,sum(CHEQUEDD_AMOUNT) AS CHEQUEDD_AMOUNT ,BANK_AMOUNT, ONLINE_AMOUNT,CARD_AMOUNT,STATUS_DESCRIPTION from (SELECT EGCL_COLLECTIONHEADER.RECEIPTNUMBER AS RECEIPT_NUMBER, EGCL_COLLECTIONHEADER.RECEIPTDATE AS RECEIPT_DATE, EG_DEPARTMENT.NAME AS DEPARTMENT_NAME, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE ='cash' THEN 'cash' WHEN EGF_INSTRUMENTTYPE.TYPE='bankchallan' THEN 'bankchallan' WHEN  EGF_INSTRUMENTTYPE.TYPE='card' THEN 'card' WHEN EGF_INSTRUMENTTYPE.TYPE='online' THEN 'online' ELSE 'cheque/dd' END)  AS INSTRUMENT_TYPE, EGCL_COLLECTIONHEADER.SOURCE AS SOURCE, EGW_STATUS.DESCRIPTION AS STATUS_DESCRIPTION, EGCL_SERVICEDETAILS.NAME AS SERVICE_NAME, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE='cash' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT END) AS CASH_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE='cheque' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT WHEN EGF_INSTRUMENTTYPE.TYPE='dd' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT END) AS CHEQUEDD_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE= 'card' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT END) AS CARD_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE= 'bankchallan' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT END) AS BANK_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.TYPE= 'online' THEN EGF_INSTRUMENTHEADER.INSTRUMENTAMOUNT END) AS ONLINE_AMOUNT FROM EGCL_COLLECTIONHEADER EGCL_COLLECTIONHEADER INNER JOIN EGCL_COLLECTIONINSTRUMENT EGCL_COLLECTIONINSTRUMENT ON EGCL_COLLECTIONHEADER.ID = EGCL_COLLECTIONINSTRUMENT.COLLECTIONHEADER INNER JOIN EGF_INSTRUMENTHEADER EGF_INSTRUMENTHEADER ON EGCL_COLLECTIONINSTRUMENT.INSTRUMENTHEADER = EGF_INSTRUMENTHEADER.ID INNER JOIN EGW_STATUS EGW_STATUS ON EGCL_COLLECTIONHEADER.STATUS = EGW_STATUS.ID INNER JOIN EGF_INSTRUMENTTYPE EGF_INSTRUMENTTYPE ON EGF_INSTRUMENTHEADER.INSTRUMENTTYPE = EGF_INSTRUMENTTYPE.ID INNER JOIN EGCL_COLLECTIONMIS EGCL_COLLECTIONMIS ON EGCL_COLLECTIONHEADER.ID = EGCL_COLLECTIONMIS.COLLECTIONHEADER INNER JOIN EG_DEPARTMENT EG_DEPARTMENT ON EG_DEPARTMENT.ID = EGCL_COLLECTIONMIS.DEPARTMENT INNER JOIN EGCL_SERVICEDETAILS EGCL_SERVICEDETAILS ON EGCL_SERVICEDETAILS.ID = EGCL_COLLECTIONHEADER.SERVICEDETAILS WHERE EGCL_COLLECTIONHEADER.RECEIPTDATE >= $P{EGOV_FROM_DATE} AND EGCL_COLLECTIONHEADER.RECEIPTDATE < $P{EGOV_TO_DATE_PLUS_ONE} $P!{Q_STATUS_ID} $P!{Q_PAYMENT_MODES} $P!{Q_DEPT_ID} $P!{Q_SOURCES} $P!{Q_SERVICE_ID} $P!{Q_CLASSIFICATION} $P!{Q_BRANCH_ID} ORDER BY EGCL_COLLECTIONHEADER.RECEIPTDATE, EGCL_COLLECTIONHEADER.RECEIPTNUMBER, EG_DEPARTMENT.NAME) AS RESULT GROUP BY RESULT.RECEIPT_NUMBER, RESULT.RECEIPT_DATE, RESULT.DEPARTMENT_NAME, RESULT.SOURCE, RESULT.INSTRUMENT_TYPE, RESULT.STATUS_DESCRIPTION, RESULT.SERVICE_NAME, RESULT.CASH_AMOUNT, RESULT.CARD_AMOUNT, RESULT.BANK_AMOUNT, RESULT.ONLINE_AMOUNT ORDER BY RESULT.RECEIPT_NUMBER, RESULT.RECEIPT_DATE, RESULT.DEPARTMENT_NAME
  
- reportName: ChequeCollection
  summary: Cheque Collection Report
  version: 1.0.0
  sourceColumns:
  - name: serialnumber
    label: reports.collection.serialno
    type: number
    source: collection
  - name: CHALLAN_NUMBER
    label: reports.collection.challanno
    type: number
    source: collection
  - name: RECEIPT_NUMBER
    label: reports.collection.receiptno
    type: number
    source: collection
  - name: DEPT_NAME
    label: reports.collection.department
    type: string
    source: collection
  - name: CHEQUE_NUMBER
    label: reports.collection.chequeno
    type: number
    source: collection
  - name: BANK
    label: reports.collection.bank
    type: number
    source: collection
  - name: BRANCH
    label: reports.collection.branch
    type: number
    source: seva
  - name: CHEQUE_DATE
    label: reports.collection.chequedate
    type: number
    source: collection
  - name: AMOUNT
    label: reports.collection.amount
    type: number
    source: collection
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  - name: collectedby
    label: reports.collection.collectedby
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  query: SELECT row_number() over (order by CH.RECEIPTNUMBER) as serialnumber, '' AS CHALLAN_NUMBER, CH.RECEIPTNUMBER AS RECEIPT_NUMBER, ED.NAME AS DEPT_NAME, '' AS CHEQUE_NUMBER, '' AS BANK, '' AS BRANCH, '' AS CHEQUE_DATE, '' AS AMOUNT FROM EGCL_RECEIPTHEADER CH, EG_DEPARTMENT ED WHERE ED.code=CH.DEPARTMENT AND CH.status != $status AND CH.RECEIPTDATE >= $fromDate AND CH.RECEIPTDATE <= $toDate AND CH.tenantid=$tenantid ORDER BY RECEIPT_NUMBER
