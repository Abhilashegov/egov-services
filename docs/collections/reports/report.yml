---
ReportDefinitions:
- reportName: CashCollection
  summary: Cash Collection Report
  version: 1.0.0
  sourceColumns:
  - name: serialnumber
    label: reports.collection.serialno
    type: number
    source: collection
  - name: CHALLAN_NUMBER
    label: reports.collection.challanno
    type: number
    source: seva
  - name: RECEIPT_NUMBER
    label: reports.collection.receiptno
    type: number
    source: completed
  - name: DEPT_NAME
    label: reports.collection.department
    type: string
    source: collection
  - name: INSTRUMENT_AMOUNT
    label: reports.collection.amount
    type: number
    source: seva
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  - name: collectedby
    label: reports.collection.collectedby
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  query: SELECT row_number() over (order by EGCL_RECEIPTHEADER.RECEIPTNUMBER) as serialnumber, '' AS CHALLAN_NUMBER, EGCL_RECEIPTHEADER.RECEIPTNUMBER AS RECEIPT_NUMBER, EG_DEPARTMENT.NAME AS DEPT_NAME, EGF_INSTRUMENT.AMOUNT AS INSTRUMENT_AMOUNT FROM egcl_receiptheader EGCL_RECEIPTHEADER INNER JOIN eg_businessdetails EGCL_SERVICEDETAILS ON EGCL_RECEIPTHEADER.businessdetails = EGCL_SERVICEDETAILS.name INNER JOIN egcl_receiptinstrument egcl_receiptinstrument ON EGCL_RECEIPTHEADER.ID = egcl_receiptinstrument.receiptheader INNER JOIN EGF_INSTRUMENT EGF_INSTRUMENT ON egcl_receiptinstrument.INSTRUMENTHEADER = EGF_INSTRUMENT.ID INNER JOIN EG_DEPARTMENT EG_DEPARTMENT ON EGCL_RECEIPTHEADER.DEPARTMENT = EG_DEPARTMENT.code WHERE EGCL_RECEIPTHEADER.status != $status AND EGCL_RECEIPTHEADER.RECEIPTDATE >= $fromDate AND EGCL_RECEIPTHEADER.RECEIPTDATE < $toDate AND EGCL_RECEIPTHEADER.tenantid=$tenantid ORDER BY RECEIPT_NUMBER
  
  
- reportName: ReceiptRegister
  summary: Receipt Register Report
  version: 1.0.0 
  sourceColumns:
  - name: RECEIPT_DATE
    label: reports.collection.receipt.date
    type: epoch
    source: collection
  - name: RECEIPT_NUMBER
    label: reports.collection.receipt.number
    type: string
    source: collection
  - name: DEPARTMENT_NAME
    label: reports.collection.department.name
    type: string
    source: collection
  - name: SERVICE_NAME
    label: reports.collection.service.name
    type: string
    source: collection
  - name: SOURCE
    label: reports.collection.source
    type: string
    source: collection
  - name: CASH_AMOUNT
    label: reports.collection.cashamount
    type: string
    source: collection
  - name: CHEQUEDD_AMOUNT
    label: reports.collection.chequedd_amount
    type: string
    source: collection
  - name: BANK_AMOUNT
    label: reports.collection.bank.amount
    type: string
    source: collection   
  - name: ONLINE_AMOUNT
    label: reports.collection.online.amount
    type: string
    source: collection   
  - name: CARD_AMOUNT
    label: reports.collection.card.amount
    type: string
    source: collection   
  - name: STATUS_DESCRIPTION
    label: reports.collection.status.description
    type: string
    source: collection  
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    source: collection
  - name: department
    label: reports.collection.department
    type: string
    source: collection 
  - name: paymentmode
    label: reports.collection.paymentmode
    type: string
    source: collection 
  - name: businessservice
    label: reports.collection.businessservice
    type: string
    source: collection  
  query: SELECT RECEIPT_DATE,RECEIPT_NUMBER,DEPARTMENT_NAME,SERVICE_NAME,INSTRUMENT_TYPE,SOURCE,CASH_AMOUNT,sum(CHEQUEDD_AMOUNT) AS CHEQUEDD_AMOUNT ,BANK_AMOUNT, ONLINE_AMOUNT,CARD_AMOUNT,STATUS_DESCRIPTION from (SELECT EGCL_RECEIPTHEADER.RECEIPTDATE AS RECEIPT_DATE, EGCL_RECEIPTHEADER.RECEIPTNUMBER AS RECEIPT_NUMBER, EG_DEPARTMENT.NAME AS DEPARTMENT_NAME, EG_DEPARTMENT.NAME AS SERVICE_NAME, (CASE WHEN EGF_INSTRUMENTTYPE.NAME ='cash' THEN 'cash' WHEN EGF_INSTRUMENTTYPE.NAME='bankchallan' THEN 'bankchallan' WHEN  EGF_INSTRUMENTTYPE.NAME='card' THEN 'card' WHEN EGF_INSTRUMENTTYPE.NAME='online' THEN 'online' ELSE 'cheque/dd' END)  AS INSTRUMENT_TYPE, EGCL_RECEIPTHEADER.CHANNEL AS SOURCE, (CASE WHEN EGF_INSTRUMENTTYPE.NAME='cash' THEN EGF_INSTRUMENT.AMOUNT END) AS CASH_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.NAME='cheque' THEN EGF_INSTRUMENT.AMOUNT WHEN EGF_INSTRUMENTTYPE.NAME='dd' THEN EGF_INSTRUMENT.AMOUNT END) AS CHEQUEDD_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.NAME= 'bankchallan' THEN EGF_INSTRUMENT.AMOUNT END) AS BANK_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.NAME= 'online' THEN EGF_INSTRUMENT.AMOUNT END) AS ONLINE_AMOUNT, (CASE WHEN EGF_INSTRUMENTTYPE.NAME= 'card' THEN EGF_INSTRUMENT.AMOUNT END) AS CARD_AMOUNT, EGCL_RECEIPTHEADER.STATUS AS STATUS_DESCRIPTION FROM EGCL_RECEIPTHEADER EGCL_RECEIPTHEADER INNER JOIN egcl_receiptinstrument egcl_receiptinstrument ON EGCL_RECEIPTHEADER.ID = egcl_receiptinstrument.receiptheader INNER JOIN EGF_INSTRUMENT EGF_INSTRUMENT ON egcl_receiptinstrument.INSTRUMENTHEADER = EGF_INSTRUMENT.ID INNER JOIN EGF_INSTRUMENTTYPE EGF_INSTRUMENTTYPE ON EGF_INSTRUMENT.INSTRUMENTTYPEID = EGF_INSTRUMENTTYPE.ID INNER JOIN EG_DEPARTMENT EG_DEPARTMENT ON EG_DEPARTMENT.code = EGCL_RECEIPTHEADER.DEPARTMENT INNER JOIN EGCL_BUSINESSDETAILS EGCL_SERVICEDETAILS ON EGCL_SERVICEDETAILS.ID = EGCL_RECEIPTHEADER.businessdetails WHERE EGCL_RECEIPTHEADER.RECEIPTDATE >= '2017-06-01'AND EGCL_RECEIPTHEADER.RECEIPTDATE < '2017-07-20'AND EGCL_RECEIPTHEADER.STATUS != 'CANCELLED'AND EGCL_RECEIPTHEADER.DEPARTMENT = 'ADMINISTRATION'AND EGCL_RECEIPTHEADER.tenantid = 'default'$P!{Q_PAYMENT_MODES} $P!{Q_SOURCES} $P!{Q_SERVICE_ID} $P!{Q_CLASSIFICATION} $P!{Q_BRANCH_ID} ORDER BY EGCL_RECEIPTHEADER.RECEIPTDATE, EGCL_RECEIPTHEADER.RECEIPTNUMBER, EG_DEPARTMENT.NAME) AS RESULT GROUP BY RESULT.RECEIPT_DATE, RESULT.RECEIPT_NUMBER, RESULT.DEPARTMENT_NAME, RESULT.SERVICE_NAME, RESULT.INSTRUMENT_TYPE, RESULT.SOURCE, RESULT.CASH_AMOUNT, RESULT.BANK_AMOUNT, RESULT.ONLINE_AMOUNT , RESULT.CARD_AMOUNT, RESULT.STATUS_DESCRIPTION ORDER BY RESULT.RECEIPT_NUMBER, RESULT.RECEIPT_DATE, RESULT.DEPARTMENT_NAME
  
- reportName: ChequeCollection
  summary: Cheque Collection Report
  version: 1.0.0
  sourceColumns:
  - name: serialnumber
    label: reports.collection.serialno
    type: number
    source: collection
  - name: CHALLAN_NUMBER
    label: reports.collection.challanno
    type: number
    source: collection
  - name: RECEIPT_NUMBER
    label: reports.collection.receiptno
    type: number
    source: collection
  - name: DEPT_NAME
    label: reports.collection.department
    type: string
    source: collection
  - name: CHEQUE_NUMBER
    label: reports.collection.chequeno
    type: number
    source: collection
  - name: BANK
    label: reports.collection.bank
    type: number
    source: collection
  - name: BRANCH
    label: reports.collection.branch
    type: number
    source: seva
  - name: CHEQUE_DATE
    label: reports.collection.chequedate
    type: number
    source: collection
  - name: AMOUNT
    label: reports.collection.amount
    type: number
    source: collection
  searchParams:
  - name: fromDate
    label: reports.collection.fromdate
    type: epoch
    source: collection
  - name: toDate
    label: reports.collection.todate
    type: epoch
    source: collection
  - name: status
    label: reports.collection.status
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  - name: collectedby
    label: reports.collection.collectedby
    type: string
    pattern: http://collection:8080/collection-master/service/v1/_search?tenantId=default|$..serviceCode|$..serviceName
    source: collection
  query: SELECT row_number() over (order by CH.RECEIPTNUMBER) as serialnumber, '' AS CHALLAN_NUMBER, CH.RECEIPTNUMBER AS RECEIPT_NUMBER, ED.NAME AS DEPT_NAME, IH.transactionnumber AS CHEQUE_NUMBER, BK.name AS BANK, IH.branchname AS BRANCH, IH.transactiondate AS CHEQUE_DATE, IH.amount AS AMOUNT FROM EGCL_RECEIPTHEADER CH, EG_DEPARTMENT ED, EGCL_RECEIPTINSTRUMENT CI, EGF_INSTRUMENT IH, egf_BANK BK WHERE ED.code=CH.DEPARTMENT AND CI.receiptheader=CH.ID AND IH.ID=CI.INSTRUMENTHEADER AND IH.BANKID=BK.code AND IH.INSTRUMENTTYPEID IN (SELECT ID FROM EGF_INSTRUMENTTYPE WHERE TYPE IN ('cheque','dd')) AND CH.status != 'Cancelled'AND CH.RECEIPTDATE >= '2017-06-01'AND CH.RECEIPTDATE < '2017-07-20'AND CH.tenantid='default'ORDER BY RECEIPT_NUMBER
