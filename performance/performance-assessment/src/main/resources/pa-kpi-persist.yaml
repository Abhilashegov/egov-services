serviceMaps:
 serviceName: Performance Assessment Service
 mappings:
 - version: 1.0
   name: kpiMaster create
   description: Create a new KPI Master Record
   fromTopic: egov.pa.newkpi-create
   queryMaps: 
    - query: INSERT INTO egpa_kpi_master (id, name, code, finyear, createdby, createddate) values (?, ?, ?, ?, ?, ?);
      basePath: $.KPIs.*
      jsonMaps:

       - jsonPath: $.KPIs.*.id
       
       - jsonPath: $.KPIs.*.name

       - jsonPath: $.KPIs.*.code
         
       - jsonPath: $.KPIs.*.finYear
         
       - jsonPath: $.RequestInfo.userInfo.id
         type: LONG
       
       - jsonPath: $.KPIs.*.createdDate
         type: LONG
         
    - query: INSERT INTO egpa_kpi_master_document (id, kpicode, documentcode, documentname, mandatoryflag, createdby, createddate)  values (nextval('seq_egpa_kpi_master_document'), ?, ?, ?, ?, ?, ?);
      basePath: $.KPIs.*.documents.*
      jsonMaps:

       - jsonPath: $.KPIs.*.documents.*.kpiCode

       - jsonPath: $.KPIs.*.documents.*.code
         
       - jsonPath: $.KPIs.*.documents.*.name
         
       - jsonPath: $.KPIs.*.documents.*.active

       - jsonPath: $.RequestInfo.userInfo.id
         type: LONG
       
       - jsonPath: $.KPIs.*.createdDate
         type: LONG
         
    - query: INSERT INTO egpa_kpi_master_targets (id, kpicode, targetvalue, targetdescription, instructions, createdby, createddate) values (nextval('seq_egpa_kpi_master_targets'), ?, ?, ?, ?, ?, ?);  
      basePath: $.KPIs.*.kpiTarget
      jsonMaps:

       - jsonPath: $.*.kpiCode

       - jsonPath: $.*.targetValue
         type: LONG
         
       - jsonPath: $.*.targetDescription
         
       - jsonPath: $.*.instructions

       - jsonPath: $.RequestInfo.userInfo.id
         type: LONG
       
       - jsonPath: $.*.createdDate
         type: LONG
 
 - version: 1.0
   name: kpiMaster update
   description: Update an existing KPI Master Record
   fromTopic: egov.pa.newkpi-update
   queryMaps: 
    - query: UPDATE egpa_kpi_master SET name = ?, finyear = ?, lastmodifiedby = ?, lastmodifieddate = ? WHERE code = ? ;
      basePath: $.KPIs.*
      jsonMaps:

       - jsonPath: $.KPIs.*.name
       
       - jsonPath: $.KPIs.*.finYear
         
       - jsonPath: $.RequestInfo.userInfo.id
         
       - jsonPath: $.KPIs.*.lastModifiedDate
         type: LONG
       
       - jsonPath: $.KPIs.*.code
      
    - query: DELETE FROM egpa_kpi_master_document WHERE kpicode = ?;
      basePath: $.KPIs.*
      jsonMaps:

       - jsonPath: $.KPIs.*.code
         
    - query: INSERT INTO egpa_kpi_master_document (id, kpicode, documentcode, documentname, mandatoryflag, createdby, createddate)  values (nextval('seq_egpa_kpi_master_document'), ?, ?, ?, ?, ?, ?);
      basePath: $.KPIs.*.documents.*
      jsonMaps:

       - jsonPath: $.KPIs.*.documents.*.kpiCode

       - jsonPath: $.KPIs.*.documents.*.code
         
       - jsonPath: $.KPIs.*.documents.*.name
         
       - jsonPath: $.KPIs.*.documents.*.active

       - jsonPath: $.RequestInfo.userInfo.id
         type: LONG
       
       - jsonPath: $.KPIs.*.createdDate
         type: LONG
         
 - version: 1.0
   name: kpiMaster delete
   description: Soft Delete an existing KPI Master Record
   fromTopic: egov.pa.newkpi-delete
   queryMaps: 
    - query: UPDATE egpa_kpi_master SET active = FALSE, lastmodifiedby = ?, lastmodifieddate = ? WHERE code = ?;
      basePath: $.KPIs.*
      jsonMaps:

       - jsonPath: $.RequestInfo.userInfo.id
         type: LONG
       
       - jsonPath: $.KPIs.*.lastModifiedDate
         type: LONG
         
       - jsonPath: $.KPIs.*.code
         type: LONG
 
 - version: 1.0
   name: kpiMasterTarget create
   description: Insert a new target for KPI Master Record
   fromTopic: egov.pa.kpitarget-create
   queryMaps: 
    - query: INSERT INTO egpa_kpi_master_targets (id, kpicode, targetvalue, targetdescription, instructions, createdby, createddate) VALUES (nextval('seq_egpa_kpi_master_targets'), ?, ?, ?, ?, ?, ? ) ;
      basePath: $.kpiTargets.*
      jsonMaps:
       
       - jsonPath: $.kpiTargets.*.kpiCode
         
       - jsonPath: $.kpiTargets.*.targetValue
         type: LONG
         
       - jsonPath: $.kpiTargets.*.targetDescription
         
       - jsonPath: $.kpiTargets.*.instructions

       - jsonPath: $.kpiTargets.*.createdBy
         type: LONG
       
       - jsonPath: $.kpiTargets.*.createdDate
         type: LONG
         
 - version: 1.0
   name: kpiMasterTarget update
   description: Update existing target for KPI Master Record
   fromTopic: egov.pa.kpitarget-update
   queryMaps: 
    - query: UPDATE egpa_kpi_master_targets SET targetvalue = ?, targetdescription = ?, instructions = ?, lastmodifiedby = ?, lastmodifieddate = ? WHERE kpicode = ? and id = ?;
      basePath: $.kpiTargets.*
      jsonMaps:

       - jsonPath: $.kpiTargets.*.targetValue
         type: LONG
         
       - jsonPath: $.kpiTargets.*.targetDescription
         
       - jsonPath: $.kpiTargets.*.instructions

       - jsonPath: $.kpiTargets.*.lastModifiedBy
         type: LONG
       
       - jsonPath: $.kpiTargets.*.lastModifiedDate
         type: LONG
         
       - jsonPath: $.kpiTargets.*.kpiCode
         type: LONG
       
       - jsonPath: $.kpiTargets.*.id
         type: LONG

 - version: 1.0
   name: kpiValue create
   description: Insert actual value for a KPI Master Record
   fromTopic: egov.pa.kpivalue-create
   queryMaps: 
    - query: INSERT INTO egpa_kpi_value (id, kpicode, tenantid, actualvalue, createdby, createddate) VALUES (nextval('seq_egpa_kpi_value'), ?, ? ,? ,? ,?) ; 
      basePath: $.kpiValues.*
      jsonMaps:
       
       - jsonPath: $.kpiValues.*.kpiCode
         
       - jsonPath: $.kpiValues.*.tenantId
         
       - jsonPath: $.kpiValues.*.actualValue
         type: LONG
         
       - jsonPath: $.kpiValues.*.createdBy
         type: LONG
       
       - jsonPath: $.kpiValues.*.createdDate
         type: LONG  
         
 - version: 1.0
   name: kpiValue update
   description: Update the actual value for a tenant for a particular KPI Master Record
   fromTopic: egov.pa.kpivalue-update
   queryMaps: 
    - query: UPDATE egpa_kpi_value SET actualvalue = ?, lastmodifiedby = ?, lastmodifieddate = ? WHERE kpicode = ? AND tenantid = ? AND id = ? 
      basePath: $.kpiValues.*
      jsonMaps:
       
       - jsonPath: $.kpiValues.*.actualValue
         type: LONG  
         
       - jsonPath: $.kpiValues.*.lastModifiedBy
         type: LONG  
         
       - jsonPath: $.kpiValues.*.lastModifiedDate
         type: LONG
         
       - jsonPath: $.kpiValues.*.kpiCode
       
       - jsonPath: $.kpiValues.*.tenantId
         
       - jsonPath: $.kpiValues.*.id
         type: LONG  