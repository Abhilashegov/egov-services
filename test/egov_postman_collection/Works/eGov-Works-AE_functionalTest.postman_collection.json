{
	"info": {
		"name": "eGov-Works-AE_functionalTest",
		"_postman_id": "4ce5c79c-a566-d78c-6fb8-664cf05c4a43",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Abstract Estimate copy",
			"description": "Abstract Estimate with workflow",
			"item": [
				{
					"name": "Login as Clerk",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"tests[\"Tenant ID is default\"] = jsonData.UserRequest.roles[0].tenantId;",
									"",
									"postman.setNextRequest(\"Create Estimate\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "clerk",
									"type": "text"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/user/oauth/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"oauth",
								"token"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Create Estimate",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "9e50aeaf-1e9c-41a4-843d-05971b6b6fe2",
								"type": "text/javascript",
								"exec": [
									"var num1 = Math.floor((Math.random() * 10000) + 1);",
									"var name2 = Math.floor(Math.random() * (999999 - 100000 + 1)) + 100000;",
									"var today = new Date();",
									"var epoch = Math.round(today.getTime()/1000);",
									"var year = today.getFullYear();",
									"",
									"pm.environment.set(\"referenceNumber\", \"RefNum\"+num1);",
									"pm.environment.set(\"epochDate\", epoch);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "7a3dc42e-af35-40fc-ae78-2e285d2ad77d",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"pm.environment.set(\"response\", jsonData);",
									"pm.environment.set(\"AE_id\", jsonData.abstractEstimates[0].id);",
									"pm.environment.set(\"AEdetails_id\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].id);",
									"pm.environment.set(\"AE_workflow\", jsonData.abstractEstimates[0].abstractEstimateNumber);",
									"pm.globals.set(\"AE_workflow\", jsonData.abstractEstimates[0].abstractEstimateNumber);",
									"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status);",
									"pm.environment.set(\"stateId\", jsonData.abstractEstimates[0].stateId);",
									"",
									"postman.setNextRequest(\"Search Estimate\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"requestInfo\": {\n    \"action\": \"create\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n  },\n  \"abstractEstimates\": [\n    {\n      \"tenantId\": \"{{tenantId}}\",\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n      \t\"code\":\"Demandfrompublic\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Hospital Construction Project Estimation for the proposed work\",\n      \"budgetGroup\": {\n        \"name\": \"4122001-CWIP-Office Buildings\"\n      },\n      \"department\": {\n        \"code\": \"ENG\"\n      },\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"EProcurement\"\n      },\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUPBSUP\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"Buildings\"\n      },\n      \"subTypeOfWork\": {\n        \"code\": \"OFFICEBUILDINGS\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"New\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"implementationPeriod\": 1,\n      \"fundAvailable\": true,\n      \"pmcRequired\": false,\n      \"workProposedAsPerDP\": false,\n      \"dpRemarks\": \"DP Remarks\",\n      \"landAssetRequired\": false,\n      \"noOfLands\": null,\n      \"otherAssetSpecificationRemarks\": \"Other Remarks\",\n      \"abstractEstimateDetails\": [\n        {\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital Building work\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Create\",\n        \"assignee\": 459\n      }\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_create",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_create"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Search Estimate",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "59240b63-3c9f-4099-90a7-519398c498da",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"postman.setNextRequest(\"Logout as Clerk\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"requestInfo\": {\n    \"action\": \"search\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n\t}\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_search"
							],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"equals": true
								},
								{
									"key": "ids",
									"value": "{{AE_id}}",
									"equals": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Logout as Clerk",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "b3181149-f32b-436b-810c-101108f83715",
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Login as HOD\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Login as HOD",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "ce8af706-54e5-455c-9d89-0c3dda536fae",
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Update Estimate\");",
									"",
									""
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "HOD",
									"type": "text"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/user/oauth/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"oauth",
								"token"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Update Estimate",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "da95bda8-1170-4fd7-9d9f-3ae332053876",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status);",
									"postman.setNextRequest(\"Search Estimate Checked\");"
								]
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "1403f27e-55f6-4481-93ba-c4ba2768aeed",
								"type": "text/javascript",
								"exec": [
									""
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"Demandfrompublic\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"4122001-CWIP-Office Buildings\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"ENG\"\n      },\n      \"status\": \"{{status}}\",\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"EProcurement\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"Buildings\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"OFFICEBUILDINGS\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"New\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Submit\",\n        \"assignee\": 509\n      }\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_update"
							]
						},
						"description": "@JE login"
					},
					"response": []
				},
				{
					"name": "Search Estimate Checked",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "e1817c88-c14a-48b1-86a7-17bbfe468b51",
								"type": "text/javascript",
								"exec": [
									"postman.setNextRequest(\"Logout as HOD\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n\t}\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&abstractEstimateNumbers={{AE_workflow}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_search"
							],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"equals": true
								},
								{
									"key": "abstractEstimateNumbers",
									"value": "{{AE_workflow}}",
									"equals": true
								}
							]
						},
						"description": "@JE login"
					},
					"response": []
				},
				{
					"name": "Logout as HOD",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "d72a57c7-1e4b-4d6d-9168-ea1114f50096",
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Login as ACC\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Login as ACC",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "8f004581-6c45-4f6d-9b04-0e321ff9e8e9",
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Update Estimate (FS)\");",
									"",
									""
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "10001",
									"type": "text"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/user/oauth/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"oauth",
								"token"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Update Estimate (FS)",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "66e73e74-d525-425c-993c-462b6b9b4d8f",
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"pm.globals.set(\"projectCode\", jsonData.abstractEstimates[0].abstractEstimateDetails[0].projectCode.code);",
									"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status);",
									"postman.setNextRequest(\"Search Estimate FS\");"
								]
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"id": "276a0fcd-5a6f-4604-a3f6-9d3b83c136e0",
								"type": "text/javascript",
								"exec": [
									"var num1 = Math.floor((Math.random() * 10000) + 1);",
									"var today = new Date();",
									"var epoch = Math.round(today.getTime()/1000);",
									"var year = today.getFullYear();",
									"pm.environment.set(\"financialSanctionNumber\", \"FS-ENG-NS-\"+year+\"-\"+num1);"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"Demandfrompublic\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"4122001-CWIP-Office Buildings\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"ENG\"\n      },\n      \"status\": \"{{status}}\",\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"EProcurement\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"Buildings\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"OFFICEBUILDINGS\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"New\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"workOrderCreated\": \"false\",\n      \"billsCreated\": \"false\",\n      \"spillOverFlag\": \"false\",\n      \"detailedEstimateCreated\": \"false\",\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"financialSanctionNumber\": \"{{financialSanctionNumber}}\",\n      \"financialSanctionDate\": \"{{epochDate}}\",\n      \"financialSanctionBy\": {\n      \t\"userName\": \"10002\"\n      },\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hospital 1\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Submit\",\n        \"assignee\": 510\n      }\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_update"
							]
						},
						"description": "@CE login"
					},
					"response": []
				},
				{
					"name": "Search Estimate FS",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "35bd05a3-0348-4738-b34d-1b87e964c9dd",
								"type": "text/javascript",
								"exec": [
									"postman.setNextRequest(\"Logout as ACC\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n\t}\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_search"
							],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"equals": true
								},
								{
									"key": "ids",
									"value": "{{AE_id}}",
									"equals": true
								}
							]
						},
						"description": "@CE login"
					},
					"response": []
				},
				{
					"name": "Logout as ACC",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "63dfd7de-b53f-454f-b57c-ce323b0d6982",
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Login as CE\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Login as CE",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "14574c10-c0e9-478e-a4de-4eede4639783",
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"postman.setNextRequest(\"Update Estimate (AS)\");",
									"",
									""
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded"
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0"
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "10002",
									"type": "text"
								},
								{
									"key": "password",
									"value": "12345678",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{url}}/user/oauth/token",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"oauth",
								"token"
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Update Estimate (AS)",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"id": "0907ba01-9a41-44bf-a312-20cd5f5e8bb7",
								"type": "text/javascript",
								"exec": [
									"var num1 = Math.floor((Math.random() * 10000) + 1);",
									"var today = new Date();",
									"var epoch = Math.round(today.getTime()/1000);",
									"var year = today.getFullYear();",
									"pm.environment.set(\"adminSanctionNumber\", \"ADN-\"+year+\"-\"+num1);",
									"pm.environment.set(\"councilResolutionNumber\", \"CRN-\"+year+\"-\"+num1);"
								]
							}
						},
						{
							"listen": "test",
							"script": {
								"id": "bddbdfb2-dff3-455c-af80-ef153d83ff00",
								"type": "text/javascript",
								"exec": [
									"pm.test(\"Status code is 200\", function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"pm.environment.set(\"status\", jsonData.abstractEstimates[0].status);",
									"postman.setNextRequest(\"Search Estimate AS\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"userInfo\": {\n     \"tenantId\": \"{{tenantId}}\"\n    }\n  },\n  \"abstractEstimates\": [\n    {\n      \"id\": \"{{AE_id}}\",\n      \"tenantId\": \"{{tenantId}}\",\n      \"abstractEstimateNumber\": \"{{AE_workflow}}\",\n      \"fund\": {\n        \"code\": \"1\"\n      },\n      \"subject\": \"Normal AE: Hospital Construction Project Work\",\n      \"referenceType\": {\n        \"code\":\"Demandfrompublic\"\n      },\n      \"referenceNumber\": \"{{referenceNumber}}\",\n      \"function\": {\n        \"code\": \"2\"\n      },\n      \"description\": \"Abstract Estimate for Project Cost Estimation\",\n      \"budgetGroup\": {\n        \"name\": \"4122001-CWIP-Office Buildings\"\n      },\n      \"scheme\": {\n        \"code\": \"2906\"\n      },\n      \"subScheme\": {\n        \"code\": \"BSUP\"\n      },\n      \"dateOfProposal\": \"{{epochDate}}\",\n      \"department\": {\n        \"code\": \"ENG\"\n      },\n      \"status\": \"{{status}}\",\n      \"stateId\": \"{{stateId}}\",\n      \"beneficiary\": \"GENERAL\",\n      \"modeOfAllotment\": {\n        \"code\": \"EProcurement\"\n      },\n      \"typeOfWork\": {\n        \"code\": \"Buildings\"\n      },\n    \"subTypeOfWork\": {\n        \"code\": \"OFFICEBUILDINGS\"\n      },\n      \"natureOfWork\": {\n        \"code\": \"New\"\n      },\n      \"ward\": {\n        \"code\": \"ward_1\"\n      },\n      \"locality\": {\n        \"code\": \"locality_1\"\n      },\n      \"workCategory\": \"NON_SLUM\",\n      \"councilResolutionNumber\": \"{{councilResolutionNumber}}\",\n      \"councilResolutionDate\": \"{{epochDate}}\",\n      \"workOrderCreated\": false,\n      \"billsCreated\": false,\n      \"spillOverFlag\": false,\n      \"detailedEstimateCreated\": false,\n      \"dpRemarks\": \"Estimation Approved by HOD\",\n      \"documentDetails\": [],\n      \"assetDetails\": [],\n      \"adminSanctionNumber\": \"{{adminSanctionNumber}}\",\n      \"adminSanctionDate\": \"{{epochDate}}\",\n      \"adminSanctionBy\": {\n      \t\"userName\": \"10002\"\n      },\n      \"abstractEstimateDetails\": [\n        {\n          \"id\": \"{{AEdetails_id}}\",\n          \"projectCode\": {\n          \t\"code\": \"{{projectCode}}\"\n          },\n          \"tenantId\": \"{{tenantId}}\",\n          \"nameOfWork\": \"Hspital 2\",\n          \"estimateAmount\": 10000\n        }\n      ],\n      \"workFlowDetails\": {\n        \"action\": \"Approve\"\n      }\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_update",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_update"
							]
						},
						"description": "@CE login"
					},
					"response": []
				},
				{
					"name": "Search Estimate AS",
					"event": [
						{
							"listen": "test",
							"script": {
								"id": "4d84996a-e4d0-4770-aade-784ced3c5663",
								"type": "text/javascript",
								"exec": [
									"postman.setNextRequest(\"Logout as CE\");"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"requestInfo\": {\n    \"action\": \"update\",\n    \"did\": \"1\",\n    \"msgId\": \"20170310130900\",\n    \"requesterId\": \"\",\n    \"authToken\": \"{{access_token}}\",\n    \"apiId\": \"1\",\n    \"ver\": \"1.0\",\n    \"ts\": 1,\n    \"key\": \"abcdkey\",\n    \"tenantId\": \"{{tenantId}}\"\n\t}\n}"
						},
						"url": {
							"raw": "{{url}}/works-estimate/v1/abstractestimates/_search?tenantId={{tenantId}}&ids={{AE_id}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"works-estimate",
								"v1",
								"abstractestimates",
								"_search"
							],
							"query": [
								{
									"key": "tenantId",
									"value": "{{tenantId}}",
									"equals": true
								},
								{
									"key": "ids",
									"value": "{{AE_id}}",
									"equals": true
								}
							]
						},
						"description": "@CE login"
					},
					"response": []
				},
				{
					"name": "Logout as CE",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"RequestInfo\": {\n    \"apiId\": \"org.egov.pgr\",\n    \"ver\": \"1.0\",\n    \"ts\": \"13-04-2017 12:13:30\",\n    \"action\": \"POST\",\n    \"did\": \"4354648646\",\n    \"key\": \"xyz\",\n    \"msgId\": \"654654\",\n    \"requesterId\": \"61\",\n    \"authToken\": \"{{access_token}}\"\n  }\n}"
						},
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true
								}
							]
						},
						"description": ""
					},
					"response": []
				}
			]
		}
	]
}