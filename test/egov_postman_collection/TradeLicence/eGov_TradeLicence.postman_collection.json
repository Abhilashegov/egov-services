{
	"variables": [],
	"info": {
		"name": "eGov_TradeLicence",
		"_postman_id": "32fb2048-a4e0-cff8-dae9-7b3b12b20399",
		"description": "",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json"
	},
	"item": [
		{
			"name": "Commons",
			"description": "",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/user/oauth/token",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded",
								"description": ""
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0",
								"description": ""
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "narasappa",
									"type": "text"
								},
								{
									"key": "password",
									"value": "demo",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "default",
									"type": "text"
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Logout",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true,
									"description": ""
								}
							],
							"variable": []
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": " {\"RequestInfo\":{\"apiId\":\"org.egov.pgr\",\"ver\":\"1.0\",\"ts\":\"13-04-2017 12:13:30\",\"action\":\"POST\",\"did\":\"4354648646\",\"key\":\"xyz\",\"msgId\":\"654654\",\"requesterId\":\"61\",\"authToken\": \"{{access_token}}\"\n }}"
						},
						"description": ""
					},
					"response": []
				}
			]
		},
		{
			"name": "Format Tests",
			"description": "",
			"item": [
				{
					"name": "Legacy trade license",
					"description": "",
					"item": [
						{
							"name": "Create Format",
							"event": [
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											"tests[\"Status code is 200\"] = responseCode.code === 200;",
											"",
											"var jsonData = JSON.parse(responseBody);",
											"",
											"var reqBody = JSON.parse(request.data);",
											"",
											"tests[\"OldLicenses matches\"] = jsonData.licenses[0].oldLicenseNumber.has(reqBody.licenses[0].oldLicenseNumber);",
											"",
											"tests[\"Owner matches\"] = jsonData.licenses[0].ownerName.has(reqBody.licenses[0].ownerName);",
											"",
											"postman.setEnvironmentVariable(\"licenseNumber\", jsonData.licenses[0].licenseNumber);"
										]
									}
								},
								{
									"listen": "prerequest",
									"script": {
										"type": "text/javascript",
										"exec": [
											"var name2 = Math.floor((Math.random() * 1000000));",
											"",
											"postman.setEnvironmentVariable(\"name\", \"Test_\"+name2);",
											"",
											"postman.setEnvironmentVariable(\"code\", name2);"
										]
									}
								}
							],
							"request": {
								"url": "{{url}}/tl-services/license/v1/_create",
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"description": ""
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n \"RequestInfo\": {\r\n \"action\": \"create\",\r\n\"did\": \"1\",\r\n\"msgId\": \"20170310130900\",\r\n\"requesterId\": \"yosadhara\",\r\n\"authToken\": \"{{access_token}}\",\r\n\"apiId\": \"1\",\r\n\"ver\": \"1.0\",\r\n\"ts\": 1,\r\n\"key\": \"abcdkey\",\r\n\"tenantId\": \"default\"\r\n},\r\n  \"licenses\": [\r\n   {\r\n         \"applicationType\":\"NEW\",\r\n         \"isLegacy\":\"true\",\r\n         \"active\":\"true\",\r\n         \"applicationDate\":\"1503144186841\",\r\n         \"isPropertyOwner\":false,\r\n         \"oldLicenseNumber\":\"{{code}}\",\r\n         \"adhaarNumber\":\"123457688879\",\r\n         \"mobileNumber\":\"7795920336\",\r\n         \"ownerName\":\"{{name}}\",\r\n         \"fatherSpouseName\":\"tharu\",\r\n         \"emailId\":\"Testing@gmail.com\",\r\n         \"ownerAddress\":\"gjhghjg\",\r\n         \"propertyAssesmentNo\":\"455677\",\r\n         \"localityId\":\"19\",\r\n         \"adminWardId\":1,\r\n         \"revenueWardId\":1,\r\n         \"ownerShipType\":\"RENTED\",\r\n         \"tradeAddress\":\"jhghgjhg\",\r\n         \"tradeTitle\":\"gfgfhf\",\r\n         \"tradeType\":\"PERMANENT\",\r\n         \"categoryId\":1,\r\n         \"subCategoryId\":25,\r\n         \"validityYears\":2,\r\n         \"feeDetails\":[\r\n            {\r\n               \"financialYear\":\"2017-18\",\r\n               \"amount\":\"2000000000\",\r\n               \"paid\":true\r\n            }\r\n         ],\r\n         \"uomName\":\"prasdad update\",\r\n         \"uomId\":1,\r\n         \"quantity\":\"2345\",\r\n         \"remarks\":\"test\",\r\n         \"licenseValidFromDate\":1503081000000,\r\n         \"tradeCommencementDate\":1503081000000,\r\n         \"agreementDate\":1503081000000,\r\n         \"agreementNo\":\"hkhkjkkjkh\",\r\n         \"tenantId\":\"default\"\r\n      }\r\n   ]\r\n}"
								},
								"description": ""
							},
							"response": []
						},
						{
							"name": "Search Format",
							"event": [
								{
									"listen": "test",
									"script": {
										"type": "text/javascript",
										"exec": [
											"tests[\"Status code is 200\"] = responseCode.code === 200;",
											"",
											"var jsonData = JSON.parse(responseBody);",
											"",
											"tests[\"Status is success\"] = responseBody.has(\"SUCCESSFUL\");",
											"",
											""
										]
									}
								}
							],
							"request": {
								"url": {
									"raw": "{{url}}/tl-services/license/v1/_search?tenantId=default",
									"host": [
										"{{url}}"
									],
									"path": [
										"tl-services",
										"license",
										"v1",
										"_search"
									],
									"query": [
										{
											"key": "tenantId",
											"value": "default",
											"equals": true,
											"description": ""
										}
									],
									"variable": []
								},
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json",
										"description": ""
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\r\n \"RequestInfo\": {\r\n \"action\": \"create\",\r\n\"did\": \"1\",\r\n\"msgId\": \"20170310130900\",\r\n\"requesterId\": \"yosadhara\",\r\n\"authToken\": \"{{access_token}}\",\r\n\"apiId\": \"1\",\r\n\"ver\": \"1.0\",\r\n\"ts\": 1,\r\n\"key\": \"abcdkey\"\r\n   }\r\n}"
								},
								"description": ""
							},
							"response": []
						}
					],
					"_postman_isSubFolder": true
				}
			]
		},
		{
			"name": "Functional Tests",
			"description": "",
			"item": [
				{
					"name": "Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var jsonData = JSON.parse(responseBody);",
									"",
									"postman.setEnvironmentVariable(\"access_token\", jsonData.access_token);",
									"",
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"",
									"postman.setNextRequest(\"Legacy trade license create\");"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/user/oauth/token",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/x-www-form-urlencoded",
								"description": ""
							},
							{
								"key": "Authorization",
								"value": "Basic ZWdvdi11c2VyLWNsaWVudDplZ292LXVzZXItc2VjcmV0",
								"description": ""
							}
						],
						"body": {
							"mode": "urlencoded",
							"urlencoded": [
								{
									"key": "username",
									"value": "narasappa",
									"type": "text"
								},
								{
									"key": "password",
									"value": "demo",
									"type": "text"
								},
								{
									"key": "grant_type",
									"value": "password",
									"type": "text"
								},
								{
									"key": "scope",
									"value": "read",
									"type": "text"
								},
								{
									"key": "tenantId",
									"value": "default",
									"type": "text"
								}
							]
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Legacy trade license create",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"",
									"var reqBody = JSON.parse(request.data);",
									"",
									"tests[\"OldLicenses matches\"] = jsonData.licenses[0].oldLicenseNumber.has(reqBody.licenses[0].oldLicenseNumber);",
									"",
									"tests[\"Owner matches\"] = jsonData.licenses[0].ownerName.has(reqBody.licenses[0].ownerName);",
									"",
									"postman.setEnvironmentVariable(\"licenseNumber\", jsonData.licenses[0].licenseNumber);",
									"",
									"tests[\"Mobile Number matches\"] = jsonData.licenses[0].mobileNumber.has(reqBody.licenses[0].mobileNumber);",
									"",
									"tests[\"Category Id matches\"] = jsonData.licenses[0].categoryId === (reqBody.licenses[0].categoryId);",
									"",
									"tests[\"Sub-Category Id matches\"] = jsonData.licenses[0].subCategoryId === (reqBody.licenses[0].subCategoryId);",
									"",
									"tests[\"Trade title matches\"] = jsonData.licenses[0].tradeTitle.has(reqBody.licenses[0].tradeTitle);",
									"",
									"tests[\"Body matches string\"] = jsonData.licenses[0].adminWardId === (reqBody.licenses[0].adminWardId);",
									"",
									"tests[\"Body matches string\"] = jsonData.licenses[0].propertyAssesmentNo.has(reqBody.licenses[0].propertyAssesmentNo);",
									"",
									"postman.setNextRequest(\"Legacy trade license search\");"
								]
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"type": "text/javascript",
								"exec": [
									"var name2 = Math.floor((Math.random() * 1000000));",
									"",
									"postman.setEnvironmentVariable(\"name\", \"Test_\"+name2);",
									"",
									"postman.setEnvironmentVariable(\"code\", name2);"
								]
							}
						}
					],
					"request": {
						"url": "{{url}}/tl-services/license/v1/_create",
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n \"RequestInfo\": {\r\n \"action\": \"create\",\r\n\"did\": \"1\",\r\n\"msgId\": \"20170310130900\",\r\n\"requesterId\": \"yosadhara\",\r\n\"authToken\": \"{{access_token}}\",\r\n\"apiId\": \"1\",\r\n\"ver\": \"1.0\",\r\n\"ts\": 1,\r\n\"key\": \"abcdkey\",\r\n\"tenantId\": \"default\"\r\n},\r\n  \"licenses\": [\r\n   {\r\n         \"applicationType\":\"NEW\",\r\n         \"isLegacy\":\"true\",\r\n         \"active\":\"true\",\r\n         \"applicationDate\":\"1503144186841\",\r\n         \"isPropertyOwner\":false,\r\n         \"oldLicenseNumber\":\"{{code}}\",\r\n         \"adhaarNumber\":\"123457688879\",\r\n         \"mobileNumber\":\"7795920336\",\r\n         \"ownerName\":\"{{name}}\",\r\n         \"fatherSpouseName\":\"tharu\",\r\n         \"emailId\":\"Testing@gmail.com\",\r\n         \"ownerAddress\":\"gjhghjg\",\r\n         \"propertyAssesmentNo\":\"455677\",\r\n         \"localityId\":\"19\",\r\n         \"adminWardId\":1,\r\n         \"revenueWardId\":1,\r\n         \"ownerShipType\":\"RENTED\",\r\n         \"tradeAddress\":\"jhghgjhg\",\r\n         \"tradeTitle\":\"gfgfhf\",\r\n         \"tradeType\":\"PERMANENT\",\r\n         \"categoryId\":1,\r\n         \"subCategoryId\":25,\r\n         \"validityYears\":2,\r\n         \"feeDetails\":[\r\n            {\r\n               \"financialYear\":\"2017-18\",\r\n               \"amount\":\"2000000000\",\r\n               \"paid\":true\r\n            }\r\n         ],\r\n         \"uomName\":\"prasdad update\",\r\n         \"uomId\":1,\r\n         \"quantity\":\"2345\",\r\n         \"remarks\":\"test\",\r\n         \"licenseValidFromDate\":1503081000000,\r\n         \"tradeCommencementDate\":1503081000000,\r\n         \"agreementDate\":1503081000000,\r\n         \"agreementNo\":\"hkhkjkkjkh\",\r\n         \"tenantId\":\"default\"\r\n      }\r\n   ]\r\n}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Legacy trade license search",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;",
									"",
									"var jsonData = JSON.parse(responseBody);",
									"",
									"tests[\"Status is success\"] = responseBody.has(\"SUCCESSFUL\");",
									"",
									"tests[\"OldLicenses matches\"] = jsonData.licenses[0].oldLicenseNumber.has(environment.code);",
									"",
									"tests[\"Owner matches\"] = jsonData.licenses[0].ownerName.has(environment.name);",
									"",
									"postman.setNextRequest(\"Logout\");"
								]
							}
						}
					],
					"request": {
						"url": {
							"raw": "{{url}}/tl-services/license/v1/_search?tenantId=default&licenseNumber={{licenseNumber}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"tl-services",
								"license",
								"v1",
								"_search"
							],
							"query": [
								{
									"key": "tenantId",
									"value": "default",
									"equals": true,
									"description": ""
								},
								{
									"key": "licenseNumber",
									"value": "{{licenseNumber}}",
									"equals": true,
									"description": ""
								}
							],
							"variable": []
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\r\n \"RequestInfo\": {\r\n \"action\": \"create\",\r\n\"did\": \"1\",\r\n\"msgId\": \"20170310130900\",\r\n\"requesterId\": \"yosadhara\",\r\n\"authToken\": \"{{access_token}}\",\r\n\"apiId\": \"1\",\r\n\"ver\": \"1.0\",\r\n\"ts\": 1,\r\n\"key\": \"abcdkey\"\r\n   }\r\n}"
						},
						"description": ""
					},
					"response": []
				},
				{
					"name": "Logout",
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"tests[\"Status code is 200\"] = responseCode.code === 200;"
								]
							}
						}
					],
					"request": {
						"url": {
							"raw": "{{url}}/user/_logout?access_token={{access_token}}",
							"host": [
								"{{url}}"
							],
							"path": [
								"user",
								"_logout"
							],
							"query": [
								{
									"key": "access_token",
									"value": "{{access_token}}",
									"equals": true,
									"description": ""
								}
							],
							"variable": []
						},
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"description": ""
							}
						],
						"body": {
							"mode": "raw",
							"raw": " {\"RequestInfo\":{\"apiId\":\"org.egov.pgr\",\"ver\":\"1.0\",\"ts\":\"13-04-2017 12:13:30\",\"action\":\"POST\",\"did\":\"4354648646\",\"key\":\"xyz\",\"msgId\":\"654654\",\"requesterId\":\"61\",\"authToken\": \"{{access_token}}\"\n }}"
						},
						"description": ""
					},
					"response": []
				}
			]
		}
	]
}